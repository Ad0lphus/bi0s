from z3 import *
import gdb
l=[]
for i in range(int('0x19',16)):
	l+=[BitVec('a'+str(i),16)]

s=Solver()

s.add((l[int("0x14",16)]^0x2B)==l[7])
s.add(l[int("0x15",16)]-l[3]==-20)
s.add((l[2]>>6)==0)
s.add(l[int("0xd",16)]==int("0x74",16))
s.add(4* l[int("0xb",16)]==int("0x17c",16))
s.add(l[7]>>(l[int("0x11",16)]%8)==5)
s.add((l[6]^0x53)==l[int('0xe',16)])
s.add(l[8]==int("0x7a",16))
s.add(l[5]<<(l[9]%8)==int("0x188",16))
s.add(l[int("0x10",16)]-l[7]==int("0x14",16))
s.add(l[7]<<(l[int("0x17",16)]%8)==int("0xbe",16))
s.add(l[2]-l[7]==int("-0x2b",16))
s.add(l[int("0x15",16)]==int("0x5f",16))
s.add((l[2]^0x47)==l[3])
s.add(l[0]==int("0x63",16))
s.add(l[int("0xd",16)]==int("0x74",16))
s.add((l[int("0x14",16)]&0x45)==int("0x44",16))
s.add((l[8]&0x15)==int("0x10",16))
s.add(l[int("0xc",16)]==int("0x5f",16))
s.add(l[4]>>4==7)
s.add(l[int("0xd",16)]==int("0x74",16))
s.add(l[0]>>(l[0]%8)==int("0xc",16))
s.add(l[10]==int("0x5f",16))
s.add((l[8]&0xAC)==int("0x28",16))
s.add(l[int("0x10",16)]==int("0x73",16))
s.add((l[int("0x16",16)]&0x1D)==int("0x18",16))
s.add(l[9]==int("0x33",16))
s.add(l[5]==int("0x31",16))
s.add(4*l[int("0x13",16)]==int("0x1c8",16))
s.add(l[int("0x14",16)]>>6==1)
s.add(l[7]>>1==int("0x2f",16))
s.add(l[1]==int("0x6c",16))
s.add(l[3]>>4==7)
s.add((l[int("0x13",16)]&0x49)==int("0x40",16))
s.add(l[4]==int("0x73",16))
s.add(l[2]&l[int("0xb",16)]==int("0x14",16))
s.add(l[0]==int("0x63",16))
s.add(l[4]+l[5]==int("0xa4",16))
s.add(l[int("0xf",16)]<<6==int("0x17c0",16))
s.add(l[int("0xa",16)]^0x2B==l[int("0x11",16)])
s.add(l[int("0xc",16)]^0x2C==l[4])
s.add(l[int("0x13",16)]-l[int("0x15",16)]==int("0x13",16))
s.add(l[int("0xc",16)]==int("0x5f",16))
s.add(l[int("0xf",16)]>>1==int("0x2f",16))
s.add(l[int("0x13",16)]==int("0x72",16))
s.add(l[int("0x11",16)]+l[int("0x12",16)]==int("0xa8",16))
s.add(l[int("0x16",16)]==int("0x3a",16))
s.add(l[int("0x17",16)]&l[int("0x15",16)]==9)
s.add(l[6]<<(l[int("0x13",16)]%8)==int("0x18c",16))
s.add(l[3]+l[7]==int("0xd2",16))
s.add((l[int("0x16",16)]&0xED)==int("0x28",16))
s.add((l[int("0xc",16)] & 0xAC)==int("0xc",16))
s.add((l[int("0x12",16)]^0x6B)==l[int("0xf",16)])
s.add((l[int("0x10",16)]&0x7A)==int("0x72",16))
s.add((l[0]&0x39)==int("0x21",16))
s.add((l[6]^0x3C)==l[int("0x15",16)])
s.add(l[int("0x14",16)]==int("0x74",16))
s.add(l[int("0x13",16)]==int("0x72",16))
s.add(l[int("0xc",16)]==int("0x5f",16))
s.add(l[2]==int("0x34",16))
s.add(l[int("0x17",16)]==int("0x29",16))
s.add(l[int("0xa",16)]==int("0x5f",16))
s.add((l[int("0x16",16)]&l[9])==int('0x32',16))
s.add(l[3]+l[2]==int('0xa7',16))
s.add(l[int('0x11',16)]-l[int('0xe',16)]==int('0x44',16))
s.add(l[int('0x15',16)]==int('0x5f',16))
s.add((l[int('0x13',16)]^0x2D)==l[int('0xa',16)])
s.add(4*l[int('0xc',16)]==int('0x17c',16))
s.add(l[6]&0x40>=1)
s.add((l[int('0xc',16)]&l[int('0x16',16)])==int('0x1a',16))
s.add(l[7]<<(l[int('0x13',16)]%8)==int('0x17c',16))
s.add((l[int('0x14',16)]^0x4E)==l[int('0x16',16)])
s.add(l[6]==int('0x63',16))
s.add(l[int('0xc',16)]==l[7])
s.add(l[int('0x13',16)]-l[int('0xd',16)]==-2)
s.add(l[int('0xe',16)]>>4==3)
s.add((l[int('0xc',16)]&0x38)==int('0x18',16))
s.add(l[8]<<(l[int('0xa',16)]%8)==int('0x3d00',16))
s.add(l[int('0x14',16)]==int('0x74',16))
s.add(l[6]>>(l[int('0x16',16)]%8)==int('0x18',16))
s.add(l[int('0x16',16)]-l[5]==9)
s.add(l[7]<<(l[int('0x16',16)]%8)==int('0x17c',16))
s.add(l[int('0x16',16)]==int('0x3a',16))
s.add(l[int('0x10',16)]==int('0x73',16))
s.add((l[int('0x17',16)]^0x1D)==l[int('0x12',16)])
s.add(l[int('0x17',16)]+l[int('0xe',16)]==int('0x59',16))
s.add((l[5]&l[2])==int('0x30',16))
s.add((l[int('0xf',16)]&0x9F)==int('0x1f',16))
s.add(l[4]==int('0x73',16))
s.add((l[int('0x17',16)]^0x4A)==l[0])
s.add((l[6]^0x3C)==l[int('0xb',16)])

print("conditions ",s.check(),'isfied :)',sep='')
a=s.model()
print("input: ",end="")
#print(a)

d,s1=dict(),''
for i in (str(a)[1:-1].split('\n')):
	s=(i.split(',')[0].split(' ='))
	d[int(s[0].split('a')[-1])]=int(s[1])
for j in sorted(d):
	s1+=chr(d[j])
	print(chr(d[j]),end='')
print()
f=open('chall2.txt','w+')
f.write(s1)
print(f.read())
gdb.execute('file chall2')
gdb.execute('r < chall2.txt')
gdb.execute('q')